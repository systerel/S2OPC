<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>S2OPC OPCUA Toolkit: src/Common/sks/sopc_sk_manager.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">S2OPC OPCUA Toolkit
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_ba210d1fa67db7bee1bb22e0a3c11d9f.html">Common</a></li><li class="navelem"><a class="el" href="dir_ff153a031a48f094c2d39e09e0849493.html">sks</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">sopc_sk_manager.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Security Keys Manager: manages local storage of the keys retrieved from the Security Keys Provider, a manager is associated to only 1 security group.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;<a class="el" href="sopc__builtintypes_8h_source.html">sopc_builtintypes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sopc__enums_8h_source.html">sopc_enums.h</a>&quot;</code><br />
</div>
<p><a href="sopc__sk__manager_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a23cf42ec27d5600075744e1f7ec63204" id="r_a23cf42ec27d5600075744e1f7ec63204"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#a23cf42ec27d5600075744e1f7ec63204">SOPC_SK_MANAGER_CURRENT_TOKEN_ID</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a23cf42ec27d5600075744e1f7ec63204"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d5096d9cdfe402c3613cfe094dd9f31" id="r_a7d5096d9cdfe402c3613cfe094dd9f31"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#a7d5096d9cdfe402c3613cfe094dd9f31">SOPC_SK_MANAGER_DEFAULT_KEYLIFETIME</a>&#160;&#160;&#160;(60 * 60 * 1000)</td></tr>
<tr class="separator:a7d5096d9cdfe402c3613cfe094dd9f31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81aef0011e0e243656d53a20094bfce5" id="r_a81aef0011e0e243656d53a20094bfce5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#a81aef0011e0e243656d53a20094bfce5">SOPC_SK_MANAGER_DEFAULT_INITIAL_SIZE</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a81aef0011e0e243656d53a20094bfce5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a2040bb48c9024a5310875b2042d0e40b" id="r_a2040bb48c9024a5310875b2042d0e40b"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#a2040bb48c9024a5310875b2042d0e40b">SOPC_SKManager</a></td></tr>
<tr class="separator:a2040bb48c9024a5310875b2042d0e40b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fd86c2a97ad16459e7d23f82ad075f2" id="r_a1fd86c2a97ad16459e7d23f82ad075f2"><td class="memItemLeft" align="right" valign="top">typedef uint32_t(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#a1fd86c2a97ad16459e7d23f82ad075f2">SOPC_SKManager_GetSize_Func</a>) (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm)</td></tr>
<tr class="memdesc:a1fd86c2a97ad16459e7d23f82ad075f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of functions to get size of the Security Key Manager.  <br /></td></tr>
<tr class="separator:a1fd86c2a97ad16459e7d23f82ad075f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e4fb311e67b5d25b141078e9a138feb" id="r_a1e4fb311e67b5d25b141078e9a138feb"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="sopc__enums_8h.html#a343b8b5b4f515a2b9a273571ac67d3ef">SOPC_ReturnStatus</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#a1e4fb311e67b5d25b141078e9a138feb">SOPC_SKManager_SetKeyLifetime_Func</a>) (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm, uint64_t KeyLifetime)</td></tr>
<tr class="separator:a1e4fb311e67b5d25b141078e9a138feb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85d52400c28b9a851675fc817193f1a8" id="r_a85d52400c28b9a851675fc817193f1a8"><td class="memItemLeft" align="right" valign="top">typedef uint64_t(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#a85d52400c28b9a851675fc817193f1a8">SOPC_SKManager_GetAllKeysLifeTime_Func</a>) (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm)</td></tr>
<tr class="separator:a85d52400c28b9a851675fc817193f1a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac557b38c0108431eb286999c8a65e5fb" id="r_ac557b38c0108431eb286999c8a65e5fb"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="sopc__enums_8h.html#a343b8b5b4f515a2b9a273571ac67d3ef">SOPC_ReturnStatus</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#ac557b38c0108431eb286999c8a65e5fb">SOPC_SKManager_SetSecurityPolicyUri_Func</a>) (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm, <a class="el" href="structSOPC__String.html">SOPC_String</a> *SecurityPolicyUri)</td></tr>
<tr class="separator:ac557b38c0108431eb286999c8a65e5fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeecfcc3a507bec6009b191171799d20b" id="r_aeecfcc3a507bec6009b191171799d20b"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="sopc__enums_8h.html#a343b8b5b4f515a2b9a273571ac67d3ef">SOPC_ReturnStatus</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#aeecfcc3a507bec6009b191171799d20b">SOPC_SKManager_SetKeys_Func</a>) (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm, const <a class="el" href="structSOPC__String.html">SOPC_String</a> *SecurityPolicyUri, uint32_t FirstTokenId, const <a class="el" href="sopc__builtintypes_8h.html#aa5c1f18d5382e4c1ca36d1430dab5531">SOPC_ByteString</a> *Keys, uint32_t NbKeys, uint64_t TimeToNextKey, uint64_t KeyLifetime)</td></tr>
<tr class="separator:aeecfcc3a507bec6009b191171799d20b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08b9b600c3e059744e84462397c7d2b7" id="r_a08b9b600c3e059744e84462397c7d2b7"><td class="memItemLeft" align="right" valign="top">typedef uint32_t(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#a08b9b600c3e059744e84462397c7d2b7">SOPC_SKManager_AddKeys_Func</a>) (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm, <a class="el" href="sopc__builtintypes_8h.html#aa5c1f18d5382e4c1ca36d1430dab5531">SOPC_ByteString</a> *Keys, uint32_t NbToken)</td></tr>
<tr class="separator:a08b9b600c3e059744e84462397c7d2b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94362ee542b4b8bec8aa0c2d9b0d8244" id="r_a94362ee542b4b8bec8aa0c2d9b0d8244"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="sopc__enums_8h.html#a343b8b5b4f515a2b9a273571ac67d3ef">SOPC_ReturnStatus</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#a94362ee542b4b8bec8aa0c2d9b0d8244">SOPC_SKManager_GetKeys_Func</a>) (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm, uint32_t StartingTokenId, uint32_t NbRequestedToken, <a class="el" href="structSOPC__String.html">SOPC_String</a> **SecurityPolicyUri, uint32_t *FirstTokenId, <a class="el" href="sopc__builtintypes_8h.html#aa5c1f18d5382e4c1ca36d1430dab5531">SOPC_ByteString</a> **Keys, uint32_t *NbKeys, uint64_t *TimeToNextKey, uint64_t *KeyLifetime)</td></tr>
<tr class="separator:a94362ee542b4b8bec8aa0c2d9b0d8244"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae96bb06212ea318e6825875838d78c5a" id="r_ae96bb06212ea318e6825875838d78c5a"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#ae96bb06212ea318e6825875838d78c5a">SOPC_SKManager_Clear_Func</a>) (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm)</td></tr>
<tr class="separator:ae96bb06212ea318e6825875838d78c5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a150fcb86ffad2b725a8350dc579eafb4" id="r_a150fcb86ffad2b725a8350dc579eafb4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#a150fcb86ffad2b725a8350dc579eafb4">SOPC_SKManager_Create</a> (const char *securityGroupId, uintptr_t userData)</td></tr>
<tr class="memdesc:a150fcb86ffad2b725a8350dc579eafb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates an instance of the default <a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> for the given security group id.  <br /></td></tr>
<tr class="separator:a150fcb86ffad2b725a8350dc579eafb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19becf8584eed4fd60e0150bfc55af0a" id="r_a19becf8584eed4fd60e0150bfc55af0a"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#a19becf8584eed4fd60e0150bfc55af0a">SOPC_SKManager_Size</a> (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm)</td></tr>
<tr class="memdesc:a19becf8584eed4fd60e0150bfc55af0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets number of managed Token for a given security group.  <br /></td></tr>
<tr class="separator:a19becf8584eed4fd60e0150bfc55af0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49f35c08de6cb25314c2a05ffd9caff8" id="r_a49f35c08de6cb25314c2a05ffd9caff8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sopc__enums_8h.html#a343b8b5b4f515a2b9a273571ac67d3ef">SOPC_ReturnStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#a49f35c08de6cb25314c2a05ffd9caff8">SOPC_SKManager_SetKeyLifetime</a> (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm, uint64_t KeyLifetime)</td></tr>
<tr class="memdesc:a49f35c08de6cb25314c2a05ffd9caff8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the keys tokens lifetimes.  <br /></td></tr>
<tr class="separator:a49f35c08de6cb25314c2a05ffd9caff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaafb0bf98880694c9f035b401a23c67c" id="r_aaafb0bf98880694c9f035b401a23c67c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sopc__enums_8h.html#a343b8b5b4f515a2b9a273571ac67d3ef">SOPC_ReturnStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#aaafb0bf98880694c9f035b401a23c67c">SOPC_SKManager_SetSecurityPolicyUri</a> (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm, <a class="el" href="structSOPC__String.html">SOPC_String</a> *SecurityPolicyUri)</td></tr>
<tr class="memdesc:aaafb0bf98880694c9f035b401a23c67c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the security policy URI for the security keys tokens.  <br /></td></tr>
<tr class="separator:aaafb0bf98880694c9f035b401a23c67c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d36e83176901ff8cbd865b1282f2cc2" id="r_a2d36e83176901ff8cbd865b1282f2cc2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sopc__enums_8h.html#a343b8b5b4f515a2b9a273571ac67d3ef">SOPC_ReturnStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#a2d36e83176901ff8cbd865b1282f2cc2">SOPC_SKManager_SetKeys</a> (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm, const <a class="el" href="structSOPC__String.html">SOPC_String</a> *SecurityPolicyUri, uint32_t FirstTokenId, const <a class="el" href="sopc__builtintypes_8h.html#aa5c1f18d5382e4c1ca36d1430dab5531">SOPC_ByteString</a> *Keys, uint32_t NbKeys, uint64_t TimeToNextKey, uint64_t KeyLifetime)</td></tr>
<tr class="memdesc:a2d36e83176901ff8cbd865b1282f2cc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets Keys of a Security Keys Manager for a given security group. After this function returns ( no matter the status ), old Keys are forgotten and cannot be accessed anymore using this SKManager. All parameters are copied by this function.  <br /></td></tr>
<tr class="separator:a2d36e83176901ff8cbd865b1282f2cc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeca1ab11c31a338b1ae0eefa677d6cc" id="r_adeca1ab11c31a338b1ae0eefa677d6cc"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#adeca1ab11c31a338b1ae0eefa677d6cc">SOPC_SKManager_AddKeys</a> (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm, <a class="el" href="sopc__builtintypes_8h.html#aa5c1f18d5382e4c1ca36d1430dab5531">SOPC_ByteString</a> *Keys, uint32_t NbToken)</td></tr>
<tr class="memdesc:adeca1ab11c31a338b1ae0eefa677d6cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds Keys to a Security Keys Manager for a given security group. New keys are appended to the end of the list of existing keys. If no keys was managed before calling this function, the first token id is set to 1 and is associated to the first new key. All parameters are copied by this function.  <br /></td></tr>
<tr class="separator:adeca1ab11c31a338b1ae0eefa677d6cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a1703ef924897568f3b09796ebf4657" id="r_a6a1703ef924897568f3b09796ebf4657"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sopc__enums_8h.html#a343b8b5b4f515a2b9a273571ac67d3ef">SOPC_ReturnStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#a6a1703ef924897568f3b09796ebf4657">SOPC_SKManager_GetKeys</a> (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm, uint32_t StartingTokenId, uint32_t NbRequestedToken, <a class="el" href="structSOPC__String.html">SOPC_String</a> **SecurityPolicyUri, uint32_t *FirstTokenId, <a class="el" href="sopc__builtintypes_8h.html#aa5c1f18d5382e4c1ca36d1430dab5531">SOPC_ByteString</a> **Keys, uint32_t *NbKeys, uint64_t *TimeToNextKey, uint64_t *KeyLifetime)</td></tr>
<tr class="memdesc:a6a1703ef924897568f3b09796ebf4657"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets Keys of a Security Keys Manager for a given security group (associated to the SKManager creation). All returned data are copied by this function. The caller is responsible for deleting these data.  <br /></td></tr>
<tr class="separator:a6a1703ef924897568f3b09796ebf4657"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af29f970d1c2072eb1cb8d653454dacb1" id="r_af29f970d1c2072eb1cb8d653454dacb1"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#af29f970d1c2072eb1cb8d653454dacb1">SOPC_SKManager_GetAllKeysLifeTime</a> (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm)</td></tr>
<tr class="memdesc:af29f970d1c2072eb1cb8d653454dacb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the total remaining lifetime of available keys tokens.  <br /></td></tr>
<tr class="separator:af29f970d1c2072eb1cb8d653454dacb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aacccdfbd96f516020ff320a399abcd" id="r_a4aacccdfbd96f516020ff320a399abcd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sopc__sk__manager_8h.html#a4aacccdfbd96f516020ff320a399abcd">SOPC_SKManager_Clear</a> (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm)</td></tr>
<tr class="memdesc:a4aacccdfbd96f516020ff320a399abcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocates Security Keys Manager data bytes content.  <br /></td></tr>
<tr class="separator:a4aacccdfbd96f516020ff320a399abcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Security Keys Manager: manages local storage of the keys retrieved from the Security Keys Provider, a manager is associated to only 1 security group. </p>
<dl class="section note"><dt>Note</dt><dd>Keys can be set or appended to previous ones </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a23cf42ec27d5600075744e1f7ec63204" name="a23cf42ec27d5600075744e1f7ec63204"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23cf42ec27d5600075744e1f7ec63204">&#9670;&#160;</a></span>SOPC_SK_MANAGER_CURRENT_TOKEN_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOPC_SK_MANAGER_CURRENT_TOKEN_ID&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7d5096d9cdfe402c3613cfe094dd9f31" name="a7d5096d9cdfe402c3613cfe094dd9f31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d5096d9cdfe402c3613cfe094dd9f31">&#9670;&#160;</a></span>SOPC_SK_MANAGER_DEFAULT_KEYLIFETIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOPC_SK_MANAGER_DEFAULT_KEYLIFETIME&#160;&#160;&#160;(60 * 60 * 1000)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a81aef0011e0e243656d53a20094bfce5" name="a81aef0011e0e243656d53a20094bfce5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81aef0011e0e243656d53a20094bfce5">&#9670;&#160;</a></span>SOPC_SK_MANAGER_DEFAULT_INITIAL_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOPC_SK_MANAGER_DEFAULT_INITIAL_SIZE&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a2040bb48c9024a5310875b2042d0e40b" name="a2040bb48c9024a5310875b2042d0e40b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2040bb48c9024a5310875b2042d0e40b">&#9670;&#160;</a></span>SOPC_SKManager</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> <a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1fd86c2a97ad16459e7d23f82ad075f2" name="a1fd86c2a97ad16459e7d23f82ad075f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fd86c2a97ad16459e7d23f82ad075f2">&#9670;&#160;</a></span>SOPC_SKManager_GetSize_Func</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint32_t(* SOPC_SKManager_GetSize_Func) (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type of functions to get size of the Security Key Manager. </p>

</div>
</div>
<a id="a1e4fb311e67b5d25b141078e9a138feb" name="a1e4fb311e67b5d25b141078e9a138feb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e4fb311e67b5d25b141078e9a138feb">&#9670;&#160;</a></span>SOPC_SKManager_SetKeyLifetime_Func</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="sopc__enums_8h.html#a343b8b5b4f515a2b9a273571ac67d3ef">SOPC_ReturnStatus</a>(* SOPC_SKManager_SetKeyLifetime_Func) (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm, uint64_t KeyLifetime)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a85d52400c28b9a851675fc817193f1a8" name="a85d52400c28b9a851675fc817193f1a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85d52400c28b9a851675fc817193f1a8">&#9670;&#160;</a></span>SOPC_SKManager_GetAllKeysLifeTime_Func</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint64_t(* SOPC_SKManager_GetAllKeysLifeTime_Func) (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac557b38c0108431eb286999c8a65e5fb" name="ac557b38c0108431eb286999c8a65e5fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac557b38c0108431eb286999c8a65e5fb">&#9670;&#160;</a></span>SOPC_SKManager_SetSecurityPolicyUri_Func</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="sopc__enums_8h.html#a343b8b5b4f515a2b9a273571ac67d3ef">SOPC_ReturnStatus</a>(* SOPC_SKManager_SetSecurityPolicyUri_Func) (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm, <a class="el" href="structSOPC__String.html">SOPC_String</a> *SecurityPolicyUri)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aeecfcc3a507bec6009b191171799d20b" name="aeecfcc3a507bec6009b191171799d20b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeecfcc3a507bec6009b191171799d20b">&#9670;&#160;</a></span>SOPC_SKManager_SetKeys_Func</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="sopc__enums_8h.html#a343b8b5b4f515a2b9a273571ac67d3ef">SOPC_ReturnStatus</a>(* SOPC_SKManager_SetKeys_Func) (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm, const <a class="el" href="structSOPC__String.html">SOPC_String</a> *SecurityPolicyUri, uint32_t FirstTokenId, const <a class="el" href="sopc__builtintypes_8h.html#aa5c1f18d5382e4c1ca36d1430dab5531">SOPC_ByteString</a> *Keys, uint32_t NbKeys, uint64_t TimeToNextKey, uint64_t KeyLifetime)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a08b9b600c3e059744e84462397c7d2b7" name="a08b9b600c3e059744e84462397c7d2b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08b9b600c3e059744e84462397c7d2b7">&#9670;&#160;</a></span>SOPC_SKManager_AddKeys_Func</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint32_t(* SOPC_SKManager_AddKeys_Func) (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm, <a class="el" href="sopc__builtintypes_8h.html#aa5c1f18d5382e4c1ca36d1430dab5531">SOPC_ByteString</a> *Keys, uint32_t NbToken)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a94362ee542b4b8bec8aa0c2d9b0d8244" name="a94362ee542b4b8bec8aa0c2d9b0d8244"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94362ee542b4b8bec8aa0c2d9b0d8244">&#9670;&#160;</a></span>SOPC_SKManager_GetKeys_Func</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="sopc__enums_8h.html#a343b8b5b4f515a2b9a273571ac67d3ef">SOPC_ReturnStatus</a>(* SOPC_SKManager_GetKeys_Func) (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm, uint32_t StartingTokenId, uint32_t NbRequestedToken, <a class="el" href="structSOPC__String.html">SOPC_String</a> **SecurityPolicyUri, uint32_t *FirstTokenId, <a class="el" href="sopc__builtintypes_8h.html#aa5c1f18d5382e4c1ca36d1430dab5531">SOPC_ByteString</a> **Keys, uint32_t *NbKeys, uint64_t *TimeToNextKey, uint64_t *KeyLifetime)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae96bb06212ea318e6825875838d78c5a" name="ae96bb06212ea318e6825875838d78c5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae96bb06212ea318e6825875838d78c5a">&#9670;&#160;</a></span>SOPC_SKManager_Clear_Func</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* SOPC_SKManager_Clear_Func) (<a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *skm)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a150fcb86ffad2b725a8350dc579eafb4" name="a150fcb86ffad2b725a8350dc579eafb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a150fcb86ffad2b725a8350dc579eafb4">&#9670;&#160;</a></span>SOPC_SKManager_Create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> * SOPC_SKManager_Create </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>securityGroupId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>userData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates an instance of the default <a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> for the given security group id. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">securityGroupId</td><td>The security group id for which the keys are managed </td></tr>
    <tr><td class="paramname">userData</td><td>User data that can be used to store additional information associated with the SKManager</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a <a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> object or NULL if not enough memory </dd></dl>

</div>
</div>
<a id="a19becf8584eed4fd60e0150bfc55af0a" name="a19becf8584eed4fd60e0150bfc55af0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19becf8584eed4fd60e0150bfc55af0a">&#9670;&#160;</a></span>SOPC_SKManager_Size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t SOPC_SKManager_Size </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *&#160;</td>
          <td class="paramname"><em>skm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets number of managed Token for a given security group. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">skm</td><td>Pointer to Security Keys Manager. Should not be NULL </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of Token or 0 if bad parameters </dd></dl>

</div>
</div>
<a id="a49f35c08de6cb25314c2a05ffd9caff8" name="a49f35c08de6cb25314c2a05ffd9caff8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49f35c08de6cb25314c2a05ffd9caff8">&#9670;&#160;</a></span>SOPC_SKManager_SetKeyLifetime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sopc__enums_8h.html#a343b8b5b4f515a2b9a273571ac67d3ef">SOPC_ReturnStatus</a> SOPC_SKManager_SetKeyLifetime </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *&#160;</td>
          <td class="paramname"><em>skm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>KeyLifetime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the keys tokens lifetimes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">skm</td><td>Pointer to Security Keys Manager. Should not be NULL </td></tr>
    <tr><td class="paramname">KeyLifetime</td><td>The keys token lifetime before keys token becomes invalid in milliseconds</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOPC_STATUS_OK if keys tokens lifetime set </dd></dl>

</div>
</div>
<a id="aaafb0bf98880694c9f035b401a23c67c" name="aaafb0bf98880694c9f035b401a23c67c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaafb0bf98880694c9f035b401a23c67c">&#9670;&#160;</a></span>SOPC_SKManager_SetSecurityPolicyUri()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sopc__enums_8h.html#a343b8b5b4f515a2b9a273571ac67d3ef">SOPC_ReturnStatus</a> SOPC_SKManager_SetSecurityPolicyUri </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *&#160;</td>
          <td class="paramname"><em>skm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSOPC__String.html">SOPC_String</a> *&#160;</td>
          <td class="paramname"><em>SecurityPolicyUri</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the security policy URI for the security keys tokens. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">skm</td><td>Pointer to Security Keys Manager. Should not be NULL </td></tr>
    <tr><td class="paramname">SecurityPolicyUri</td><td>The URI for the set of algorithms and key lengths used to secure the messages </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOPC_STATUS_OK if security policy URI set </dd></dl>

</div>
</div>
<a id="a2d36e83176901ff8cbd865b1282f2cc2" name="a2d36e83176901ff8cbd865b1282f2cc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d36e83176901ff8cbd865b1282f2cc2">&#9670;&#160;</a></span>SOPC_SKManager_SetKeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sopc__enums_8h.html#a343b8b5b4f515a2b9a273571ac67d3ef">SOPC_ReturnStatus</a> SOPC_SKManager_SetKeys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *&#160;</td>
          <td class="paramname"><em>skm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structSOPC__String.html">SOPC_String</a> *&#160;</td>
          <td class="paramname"><em>SecurityPolicyUri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>FirstTokenId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="sopc__builtintypes_8h.html#aa5c1f18d5382e4c1ca36d1430dab5531">SOPC_ByteString</a> *&#160;</td>
          <td class="paramname"><em>Keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>NbKeys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>TimeToNextKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>KeyLifetime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets Keys of a Security Keys Manager for a given security group. After this function returns ( no matter the status ), old Keys are forgotten and cannot be accessed anymore using this SKManager. All parameters are copied by this function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">skm</td><td>Pointer to Security Keys Manager. Should not be NULL </td></tr>
    <tr><td class="paramname">SecurityPolicyUri</td><td>The URI for the set of algorithms and key lengths used to secure the messages </td></tr>
    <tr><td class="paramname">FirstTokenId</td><td>The SecurityTokenId of the first key in the array of returned keys. </td></tr>
    <tr><td class="paramname">Keys</td><td>An ordered list of keys that are used when the KeyLifetime elapses </td></tr>
    <tr><td class="paramname">NbKeys</td><td>The number of keys tokens in <code>Keys</code> array </td></tr>
    <tr><td class="paramname">TimeToNextKey</td><td>The time, in milliseconds, before the CurrentKey is expected to expire </td></tr>
    <tr><td class="paramname">KeyLifetime</td><td>The lifetime of a key in milliseconds </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOPC_STATUS_OK if keys are set </dd></dl>

</div>
</div>
<a id="adeca1ab11c31a338b1ae0eefa677d6cc" name="adeca1ab11c31a338b1ae0eefa677d6cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeca1ab11c31a338b1ae0eefa677d6cc">&#9670;&#160;</a></span>SOPC_SKManager_AddKeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t SOPC_SKManager_AddKeys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *&#160;</td>
          <td class="paramname"><em>skm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sopc__builtintypes_8h.html#aa5c1f18d5382e4c1ca36d1430dab5531">SOPC_ByteString</a> *&#160;</td>
          <td class="paramname"><em>Keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>NbToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds Keys to a Security Keys Manager for a given security group. New keys are appended to the end of the list of existing keys. If no keys was managed before calling this function, the first token id is set to 1 and is associated to the first new key. All parameters are copied by this function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">skm</td><td>Pointer to Security Keys Manager. Should not be NULL </td></tr>
    <tr><td class="paramname">Keys</td><td>The keys data </td></tr>
    <tr><td class="paramname">NbToken</td><td>The number of keys token (set of keys) to add</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of added elements </dd></dl>

</div>
</div>
<a id="a6a1703ef924897568f3b09796ebf4657" name="a6a1703ef924897568f3b09796ebf4657"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a1703ef924897568f3b09796ebf4657">&#9670;&#160;</a></span>SOPC_SKManager_GetKeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sopc__enums_8h.html#a343b8b5b4f515a2b9a273571ac67d3ef">SOPC_ReturnStatus</a> SOPC_SKManager_GetKeys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *&#160;</td>
          <td class="paramname"><em>skm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>StartingTokenId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>NbRequestedToken</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSOPC__String.html">SOPC_String</a> **&#160;</td>
          <td class="paramname"><em>SecurityPolicyUri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>FirstTokenId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sopc__builtintypes_8h.html#aa5c1f18d5382e4c1ca36d1430dab5531">SOPC_ByteString</a> **&#160;</td>
          <td class="paramname"><em>Keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>NbKeys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&#160;</td>
          <td class="paramname"><em>TimeToNextKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&#160;</td>
          <td class="paramname"><em>KeyLifetime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets Keys of a Security Keys Manager for a given security group (associated to the SKManager creation). All returned data are copied by this function. The caller is responsible for deleting these data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">skm</td><td>Pointer to Security Keys Manager. Should not be NULL </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">StartingTokenId</td><td>The current token is requested by passing 0. It can be a SecurityTokenId from the past to get a key valid for previously sent messages </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">NbRequestedToken</td><td>The number of requested keys tokens which should be returned in the response </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SecurityPolicyUri</td><td>The URI for the set of algorithms and key lengths used to secure the messages </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">FirstTokenId</td><td>The SecurityTokenId of the first key in the array of returned keys. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Keys</td><td>An ordered list of keys that are used when the KeyLifetime elapses </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">NbKeys</td><td>The number of keys tokens in <code>Keys</code> array </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">TimeToNextKey</td><td>The time, in milliseconds, before the CurrentKey is expected to expire </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">KeyLifetime</td><td>The lifetime of a key in milliseconds </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SOPC_STATUS_OK if keys are get </dd></dl>

</div>
</div>
<a id="af29f970d1c2072eb1cb8d653454dacb1" name="af29f970d1c2072eb1cb8d653454dacb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af29f970d1c2072eb1cb8d653454dacb1">&#9670;&#160;</a></span>SOPC_SKManager_GetAllKeysLifeTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t SOPC_SKManager_GetAllKeysLifeTime </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *&#160;</td>
          <td class="paramname"><em>skm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the total remaining lifetime of available keys tokens. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">skm</td><td>Pointer to Security Keys Manager. Should not be NULL </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Total remaining lifetime in milliseconds or it shall be 0 in case of error or no key available </dd></dl>

</div>
</div>
<a id="a4aacccdfbd96f516020ff320a399abcd" name="a4aacccdfbd96f516020ff320a399abcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4aacccdfbd96f516020ff320a399abcd">&#9670;&#160;</a></span>SOPC_SKManager_Clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SOPC_SKManager_Clear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSOPC__SKManager.html">SOPC_SKManager</a> *&#160;</td>
          <td class="paramname"><em>skm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocates Security Keys Manager data bytes content. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">skm</td><td>Pointer to Security Keys Manager. Should not be NULL </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Dec 17 2025 13:45:56 for S2OPC OPCUA Toolkit by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
