<?xml version="1.0" encoding="utf-8"?>
<ModelDesign
  xmlns:xsd="http://www.w3.org/2001/XMLSchema"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:ua="http://opcfoundation.org/UA/"
  xmlns:uax="http://opcfoundation.org/UA/2008/02/Types.xsd"
  xmlns="http://opcfoundation.org/UA/ModelDesign.xsd"
  xmlns:Alstom="https://www.systerel.fr/S2OPC/Alstom"
  TargetNamespace="https://www.systerel.fr/S2OPC/Alstom"
  TargetVersion="1.0.0" TargetPublicationDate="2021-09-01T00:00:00Z">
  <Namespaces>
    <Namespace Name="AlstNS" Prefix="AlstNS">https://www.systerel.fr/S2OPC/Alstom</Namespace>
    <Namespace Name="OpcUa" Prefix="Opc.Ua" InternalPrefix="Opc.Ua.Server" XmlNamespace="http://opcfoundation.org/UA/2008/02/Types.xsd" XmlPrefix="OpcUa">http://opcfoundation.org/UA/</Namespace>
  </Namespaces>

  <ObjectType SymbolicName="Alstom:Configuration_NodeType" BaseType="ua:BaseObjectType">
    <Description>
      CONFIGURATION STEP
    </Description>
    <Children>
      <Object SymbolicName="Alstom:Items" TypeDefinition="Alstom:Items_NodeType" ModellingRule="Mandatory"/>
      <Object SymbolicName="Alstom:RemoteReset" TypeDefinition="Alstom:RemoteReset_NodeType" ModellingRule="Mandatory"/>
    </Children>
  </ObjectType>

  <Method SymbolicName="Alstom:RemoteExecution_NodeType">
    <Description>
      Method that triggers the remote reset execution of the whole cubicle. This Method has one OutputArgument: Confirmation. 
    </Description>
    <Children>
      <Property SymbolicName="ua:OutputArguments" DataType="ua:Argument" ValueRank="Array" ModellingRule="Mandatory">
        <DefaultValue>
          <uax:ListOfExtensionObject>
            <uax:ExtensionObject>
              <uax:TypeId>
                <uax:Identifier>i=297</uax:Identifier>
              </uax:TypeId>
              <uax:Body>
                <uax:Argument>
                  <uax:Name>Confirmation</uax:Name>
                  <uax:DataType>
                    <uax:Identifier>i=1</uax:Identifier>
                  </uax:DataType>
                  <uax:ValueRank>-1</uax:ValueRank>
                  <uax:ArrayDimensions />
                  <uax:Description/>
                </uax:Argument>
              </uax:Body>
            </uax:ExtensionObject>
          </uax:ListOfExtensionObject>
        </DefaultValue>
      </Property>
    </Children>
  </Method>

  <ObjectType SymbolicName="Alstom:Item_NodeType" BaseType="ua:BaseObjectType">
    <Description>
      Item node for configuration
    </Description>
    <Children>
      <Property SymbolicName="Alstom:ActivationState" ModellingRule="Mandatory" DataType="ua:String" AccessLevel="ReadWrite">
        <Description>
          Variable used to indicate the state of the activation.
        </Description>
        <DefaultValue>
          <uax:String>NotYetActivatable</uax:String>
        </DefaultValue>
      </Property>
      <Property SymbolicName="Alstom:PreloadState" ModellingRule="Mandatory" DataType="ua:String" AccessLevel="ReadWrite">
        <Description>
          Variable used to indicate the state of the preload.
        </Description>
        <DefaultValue>
          <uax:String>NotYetPreloadable</uax:String>
        </DefaultValue>
      </Property>
      <Property SymbolicName="Alstom:ConfigurationItemId" ModellingRule="Mandatory" DataType="ua:String" AccessLevel="ReadWrite">
        <Description>
          Identification of the configuration item.
        </Description>
        <DefaultValue>
          <uax:String>DEHG2_XIO___37##0005</uax:String>
        </DefaultValue>
      </Property>
      <Property SymbolicName="Alstom:CurrentVersion" ModellingRule="Mandatory" DataType="ua:String" AccessLevel="ReadWrite">
        <Description>
          Version of the current configuration item running in STEP.
        </Description>
        <DefaultValue>
          <uax:String>yyyymmdd_hhmm</uax:String>
        </DefaultValue>
      </Property>
      <Property SymbolicName="Alstom:PreloadedVersion" ModellingRule="Mandatory" DataType="ua:String" AccessLevel="ReadWrite">
        <Description>
          Version of the preloaded configuration item in STEP.
        </Description>
        <DefaultValue>
          <uax:String>yyyymmdd_hhmm</uax:String>
        </DefaultValue>
      </Property>
      <Object SymbolicName="Alstom:PreloadFile" TypeDefinition="ua:FileType" ModellingRule="Mandatory">
        <Description>
          Package file containing the configuration to be uploaded and then activated in the target. This is a targz.
        </Description>
      </Object>
      <Object SymbolicName="Alstom:Signature" TypeDefinition="ua:FileType" ModellingRule="Mandatory">
        <Description>
          Text file containing the signature of the package file of the configuration item. This signature is needed for the preload. This is the SHA384 of the targz.
        </Description>
      </Object>
      <Method SymbolicName="Alstom:AbortUpdateProcess" ModellingRule="Mandatory">
        <Description>
          Method used to request the abort of the update. This abort is possible as long as the activate has not been called by the MDM. 
        </Description>
      </Method>
      <Method SymbolicName="Alstom:Activate" ModellingRule="Mandatory">
        <Description>
          Method used to request the activation of the configuration item. This corresponds to a switch configuration in STEP.
        </Description>
      </Method>
    </Children>
  </ObjectType>

  <ObjectType SymbolicName="Alstom:StepSafetyParameters_NodeType" BaseType="ua:BaseObjectType">
    <Description>
      Node which gathers safety parameters
    </Description>
    <Children>
      <Method SymbolicName="Alstom:ActivationParam" ModellingRule="Mandatory">
        <Description>
          Method used to confirm the activation request of the configuration item. This corresponds to a confirmation of the safety switch. 
        </Description>
      </Method>
      <Property SymbolicName="Alstom:Safety_Client_ID" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Scrambled_GID_A" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Scrambled_GID_B" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Freshness_A_Primary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Freshness_B_Primary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Freshness_A_Secondary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Freshness_B_Secondary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Identification_A_Primary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Identification_B_Primary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Identification_A_Secondary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Identification_B_Secondary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Checksum1_A_Conf_Primary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Checksum1_B_Conf_Primary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Checksum1_A_CSS_Primary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Checksum1_B_CSS_Primary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Checksum1_A_Conf_Secondary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Checksum1_B_Conf_Secondary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Checksum1_A_CSS_Secondary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Checksum1_B_CSS_Secondary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Status_Primary" ModellingRule="Mandatory" DataType="ua:Byte" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Status_Code_Primary" ModellingRule="Mandatory" DataType="ua:Byte" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Status_Secondary" ModellingRule="Mandatory" DataType="ua:Byte" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Status_Code_Secondary" ModellingRule="Mandatory" DataType="ua:Byte" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Checksum2_A_Primary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Checksum2_B_Primary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Checksum2_A_Secondary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Checksum2_B_Secondary" ModellingRule="Mandatory" DataType="ua:UInt32" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Command_OpType" ModellingRule="Mandatory" DataType="ua:Byte" AccessLevel="ReadWrite"/>
      <Property SymbolicName="Alstom:Command_SubOptType" ModellingRule="Mandatory" DataType="ua:Byte" AccessLevel="ReadWrite"/>
    </Children>
  </ObjectType>

  <ObjectType SymbolicName="Alstom:Item_non_safety_NodeType" BaseType="Alstom:Item_NodeType">
    <Description>
      Item node for non-safety relevant configuration (functional and cybersecurity)
    </Description>
    <Children>
      <Property SymbolicName="Alstom:isSafetyRelevant" ModellingRule="Mandatory" DataType="ua:Boolean" AccessLevel="ReadWrite">
        <DefaultValue>
          <uax:Boolean>0</uax:Boolean>
        </DefaultValue>
      </Property>
    </Children>
  </ObjectType>

  <ObjectType SymbolicName="Alstom:Item_safety_NodeType" BaseType="Alstom:Item_NodeType">
    <Description>
      Item node for safety relevant configuration
    </Description>
    <Children>
      <Object SymbolicName="Alstom:StepSafetyParameters" TypeDefinition="Alstom:StepSafetyParameters_NodeType" ModellingRule="Mandatory"/>
      <Property SymbolicName="Alstom:isSafetyRelevant" ModellingRule="Mandatory" DataType="ua:Boolean" AccessLevel="ReadWrite">
        <DefaultValue>
          <uax:Boolean>1</uax:Boolean>
        </DefaultValue>
      </Property>
    </Children>
  </ObjectType>

  <ObjectType SymbolicName="Alstom:Items_NodeType" BaseType="ua:BaseObjectType">
    <Description>
      Items node for non-safety and safety relevant configuration
    </Description>
    <Children>
      <Object SymbolicName="Alstom:Item1" TypeDefinition="Alstom:Item_non_safety_NodeType" ModellingRule="Mandatory"/>
      <Object SymbolicName="Alstom:Item2" TypeDefinition="Alstom:Item_non_safety_NodeType" ModellingRule="Mandatory"/>
      <Object SymbolicName="Alstom:Item3" TypeDefinition="Alstom:Item_safety_NodeType" ModellingRule="Mandatory"/>
      <Method SymbolicName="Alstom:MaintainingFinished" ModellingRule="Mandatory"/>
      <Property SymbolicName="Alstom:OperationState" ModellingRule="Mandatory" DataType="ua:String" AccessLevel="ReadWrite">
        <DefaultValue>
          <uax:String>NotMaintenance</uax:String>
        </DefaultValue>
      </Property>
    </Children>
  </ObjectType>

  <ObjectType SymbolicName="Alstom:RemoteReset_NodeType" BaseType="ua:BaseObjectType">
    <Description>
      Node dedicated to the remote reset process (NeuPro)
    </Description>
    <Children>
      <Method SymbolicName="Alstom:RemoteExecution" TypeDefinition="Alstom:RemoteExecution_NodeType" ModellingRule="Mandatory"/>
      <Property SymbolicName="Alstom:Executable" ModellingRule="Mandatory" DataType="ua:Boolean" AccessLevel="ReadWrite">
        <DefaultValue>
          <uax:Boolean>0</uax:Boolean>
        </DefaultValue>
      </Property>
    </Children>
  </ObjectType>

  <Object SymbolicName="Alstom:Configuration" TypeDefinition="Alstom:Configuration_NodeType">
    <References>
      <Reference IsInverse="true">
        <!-- Put the instance under Root/Objects -->
        <ReferenceType>ua:Organizes</ReferenceType>
        <TargetId>ua:ObjectsFolder</TargetId>
      </Reference>
    </References>
  </Object>
</ModelDesign>

